在网上看到一道题，感觉还挺好的，比较贴近业务。原文是用spark写的，我打算用sql和spark都试一下，整理一下看能不能写出来：



题目

给定一张表，两个字段，用户id和用户登录的日期。假设业务开始时间从2020年1月1日开始，即1月1日登录的都是新用户。示例数据如下：

```
2020-01-01	a
2020-01-01	b
2020-01-01	c
-----------------
2020-01-02	a(不是新用户)
2020-01-02	b(不是新用户)
2020-01-02	d
----------------
2020-01-03	b(不是新用户)
2020-01-03	e
2020-01-03	f
```

以上数据要求的输出结果为：
2020-01-01 新增三个用户（a,b,c）
2020-01-02 新增一个用户（d）
2020-01-03 新增两个用户（e，f）



sql解题思路

额，又没想出来。。。

[a,b,c]

[a,b,d]

感觉应该有个

spark解题思路







原文链接

https://dongkelun.com/2018/04/11/sparkNewUV/